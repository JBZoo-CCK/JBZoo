/**
 * JBZoo App is universal Joomla CCK, application for YooTheme Zoo component
 *
 * @package     jbzoo
 * @version     2.x Pro
 * @author      JBZoo App http://jbzoo.com
 * @copyright   Copyright (C) JBZoo.com,  All rights reserved.
 * @license     http://jbzoo.com/license-pro.php JBZoo Licence
 * @coder       Denis Smetannikov <denis@jbzoo.com>
 * @coder       Vitaliy Yanovskiy <joejoker@jbzoo.com>
 */

var JBZooHelper=function(){var a=this,e=jQuery;a.DEBUG=!1;a.numberFormat=function(a,c,b,h){if(isNaN(a))return null;b=b?b:".";a=new String(a);a=a.split(".");if(h){for(var e=[],f=a[0].length,g=0;0<f;f-=3){var m=0<f?f-3:f;e[g++]=a[0].substring(f,m)}a[0]=e.reverse().join(h)}if(c)for(a[1]=a[1]?a[1]:"",a[1]=Math.round(parseFloat(a[1].substr(0,c)+"."+a[1].substr(c,a[1].length),10)),isNaN(a[1])&&(a[1]=""),c-=a[1].toString().length,f=0;f<c;f++)a[1]+="0";return a.join(b)};a.logger=function(d,c,b){if(!a.DEBUG||
"undefined"==typeof console)return!1;"e"==d?void 0!==b?console.error(c+"\t\t\t\tvars:",b):console.error(c):"w"==d?void 0!==b?console.warn(c+"\t\t\t\tvars:",b):console.warn(c):"i"==d?void 0!==b?console.info(c+"\t\t\t\tvars:",b):console.info(c):void 0!==b?console.log(c+"\t\t\t\tvars:",b):console.log(c)};a.ajax=function(d){a.logger("w","ajax::request",d);d=e.extend({},{url:"index.php?format=raw&tmpl=component",data:{},dataType:"json",success:!1,error:!1,onFatal:function(c){if(a.DEBUG){a.logger("e","ajax::request - "+
d.url,d.data);var b=e.parseHTML(c.responseText),h="";JBZoo.empty(b)||e.each(b,function(a,b){if(1==e(b).find("#techinfo").length)return h=e.trim(e(b).find("#techinfo").text()),!1});h?jbdump(h,"Ajax error responce:"):jbdump(c.responseText,"Ajax error responce:")}throw"Ajax response no parse";}},d);if(!d.url)throw"AJAX url is no set!";d.data=e.extend({},{nocache:Math.random(),option:"com_zoo",tmpl:"component",format:"raw"},d.data);e.ajax({url:d.url,data:d.data,dataType:d.dataType,type:"POST",success:function(a){"string"==
typeof a&&(a=e.trim(a));"json"==d.dataType?a.result&&e.isFunction(d.success)?d.success.apply(this,arguments):!a.result&&e.isFunction(d.error)&&d.error.apply(this,arguments):e.isFunction(d.success)&&d.success.apply(this,arguments)},error:d.onFatal,cache:!1,headers:{"cache-control":"no-cache"}})};a.empty=function(d){return"undefined"===typeof d||""===d||0===d||"0"===d||null===d||!1===d||"object"==typeof d&&0==a.countProps(d)?!0:!1};a.countProps=function(a){var c=0,b;for(b in a)a.hasOwnProperty(b)&&
c++;return c};a.trace=function(d){if(!a.DEBUG||"undefined"==typeof console)return!1;a.empty(d)&&(d=!1);var c=function(){var a={};Error.captureStackTrace(a,c);return a.stack};d?jbdump(c(),"trace",!1):"undefined"!=typeof console&&console.trace()};a.die=function(d){if(!a.DEBUG)return!1;a.empty(d)&&(d=" -= ! DIE ! =-");throw d;};a.in_array=function(a,c,b){var h=!1,e;b=!!b;for(e in c)if(b&&c[e]===a||!b&&c[e]==a){h=!0;break}return h};a.jbdump=function(a,c,b){var h="string"==typeof a||"array"==typeof a?
" ("+typeof a+", "+a.length+")":" ("+typeof a+")";"string"==typeof a&&(a='"'+a+'"');"undefined"==typeof b&&(b=!1);console.log("undefined"==typeof c?"..."+h+" = ":c+(h+" = "),a);b&&"undefined"!=typeof console.trace&&console.trace();return!0}},reCount={options:{decimals:2,point:".",separator:" ",currency:"EUR",duration:1E3},process:!1,element:null,elements:[],hash:null,add:function(a,e,d){var c=this;c.setOptions(d);c.element=a;var b=c.options;d=c.getValue(a);c.process=!0;jQuery({value:d.value}).animate({value:e.noformat},
{easing:"swing",step:function(){var d=parseInt(this.value,10);0<b.decimals&&(d=c.toFormat(parseFloat(this.value)));jQuery(a).text(" "+d+" ")},complete:function(){jQuery(a).text(e.total);c.process=!1},duration:b.duration});return this},getValue:function(a){var e=0;"undefined"==typeof a.attr("type")&&(e=a.text(),e=this.clean(e));return e},setValue:function(a){"undefined"==typeof this.element.attr("type")&&this.element.text(a);return this},clean:function(a){a=a.replace(/[\s]/g,"");a=parseInt(a,10);return{value:a,
total:this.toFormat(a)}},toFormat:function(a,e,d,c){if(isNaN(a))return null;d=d?d:this.options.point;c=c?c:this.options.separator;e=e?e:this.options.decimals;a=new String(a);a=a.split(".");if(c){for(var b=[],h=a[0].length,k=0;0<h;h-=3){var f=0<h?h-3:h;b[k++]=a[0].substring(h,f)}a[0]=b.reverse().join(c)}if(e)for(a[1]=a[1]?a[1]:"",a[1]=Math.round(parseFloat(a[1].substr(0,e)+"."+a[1].substr(e,a[1].length),10)),isNaN(a[1])&&(a[1]=""),e-=a[1].toString().length,h=0;h<e;h++)a[1]+="0";return a.join(d)},setOptions:function(a){for(var e in a)this.options.hasOwnProperty(e)&&
0<a[e].length&&(this.options[e]=a[e]);return this},trash:function(){this.element=null;this.options={}}};
(function(a){a(document).on("click",".jbzoo .jsEmptyCart",function(){JBZoo.ajax({url:a(this).attr("href"),success:function(){a.fn.JBZooPriceReloadBasket()}});return!1});a(document).on("click",".jbzoo .jsGoto",function(){var e=a(this).attr("href");e||(e=a(this).data("href"));parent.location.href=e;return!1});a.fn.JBZooTabs=function(e){e=a.extend({},{onTabShow:!1,indexTab:0},e);return a(this).each(function(){var d=a(this),c=d.children("ul"),b=c.children("li"),h=b.children("a"),k=d.children("div");if(d.hasClass("jbzootabs-widget"))return!0;
d.addClass("jbzootabs jbzootabs-widget jbzootabs-widget-cont");h.addClass("jbzootabs-anchor");c.addClass("jbzootabs-nav jbzootabs-header");b.addClass("jbzootabs-state-default");k.addClass("jbzootabs-content");k.hide();b.hover(function(){a(this).addClass("jbzootabs-state-hover")},function(){a(this).removeClass("jbzootabs-state-hover")});h.bind("click",function(){var c=a(this,d).attr("href").match(/#(.*)$/);k.hide();a(c[0],d).show();b.removeClass("jbzootabs-active jbzootabs-state-active");a(this).parent().addClass("jbzootabs-active jbzootabs-state-active");
a.isFunction(e.onTabShow)&&(c=a(b,d).index(a(".jbzootabs-active",d)),e.onTabShow(c));return!1});(function(){var f=window.location.href.match(/#(.*)$/);if(f&&f[1]){var f=window.location.hash,g=k.siblings().not(c).index(a(f,d));0<g?(a(f,d).show(),b.eq(g).addClass("jbzootabs-active jbzootabs-state-active")):(b.eq(e.indexTab).addClass("jbzootabs-active jbzootabs-state-active"),k.first().show())}else 0<e.indexTab?(k.not(c).eq(e.indexTab).show(),b.eq(e.indexTab).addClass("jbzootabs-active jbzootabs-state-active")):
(b.eq(e.indexTab).addClass("jbzootabs-active jbzootabs-state-active"),k.first().show())})()})};a.fn.JBZooAccordion=function(e){e=a.extend({},{onTabShow:!1,headerWidget:"h3",contentWidget:"div",activeTab:0},e);return a(this).each(function(){var d=a(this);if(d.hasClass("jbzootabs-accordion"))return!0;if("h3"==e.headerWidget)var c=d.children(e.contentWidget),b=d.children(e.headerWidget);else c=d.children(e.contentWidget+":odd"),b=d.children("div:even");c.hide();b.hover(function(){a(this).addClass("jbzootabs-state-hover")},
function(){a(this).removeClass("jbzootabs-state-hover")});a(d).addClass("jbzootabs-accordion");a(b).addClass("jbzootabs-accordion-header jbzootabs-state-default jbzootabs-accordion-icons");a(b).append('<span class="jbzootabs-accordion-header-icon jbzootabs-icon jbzootabs-icon-closed"></span>');a(c).addClass("jbzootabs-accordion-content");b.bind("click",function(){var h=a(this,d).next(),k=a(this,d).find(".jbzootabs-accordion-header-icon"),f=b.find(".jbzootabs-accordion-header-icon");b.removeClass("jbzootabs-accordion-active jbzootabs-state-active");
f.removeClass("jbzootabs-icon-opened");a(c).slideUp("normal");a(h).is(":hidden")&&(a(this,d).addClass("jbzootabs-accordion-active"),k.addClass("jbzootabs-icon-opened"),a(h).slideDown("normal"));a.isFunction(e.onTabShow)&&(index=b.index(a(".jbzootabs-accordion-active",d)),a(".googlemaps").children("div").first().data("Googlemaps").refresh())});b.eq(e.activeTab).addClass("jbzootabs-accordion-active jbzootabs-state-active");$allSpan=b.find(".jbzootabs-accordion-header-icon");$allSpan.eq(e.activeTab).addClass("jbzootabs-icon-opened");
c.eq(e.activeTab).slideDown("normal")})};a.fn.reCount=function(e,d){var c=a.extend({},{decimals:2,point:".",separator:" ",currency:"EUR",duration:250},d),b=a(this);a(this).each(function(){function d(g,f,e,n){a({value:g}).animate({value:parseFloat(b.clean(f))},{step:function(g,q){var r=parseInt(this.value,10);0<c.decimals&&(r=b.toFormat(parseFloat(this.value)));k(r);.95<parseFloat((q.now-q.start)/(q.end-q.start)).toFixed(2)&&!0===n&&(a(q.elem).stop(),e+=2*e,d(this.value,f,e))},complete:function(){k(f);
b.process=!1},duration:e})}function k(a){"undefined"==typeof f.attr("type")&&f.html(" "+a+" ");return f}var f=a(this);b.add=function(a){var f=b.getValue();d(f,a,c.duration,!0)};b.getValue=function(){var a=0;"undefined"==typeof f.attr("type")&&(a=f.text(),a=this.clean(a));return a};b.clean=function(a){a=(a+"").toString().replace(/[\s]/g,"");return a=parseInt(a,10)};b.toFormat=function(a,b,d,f){if(isNaN(a))return null;d=d?d:c.point;f=f?f:c.separator;b=b?b:c.decimals;a=new String(a);a=a.split(".");if(f){for(var e=
[],h=a[0].length,r=0;0<h;h-=3){var k=0<h?h-3:h;e[r++]=a[0].substring(h,k)}a[0]=e.reverse().join(f)}if(b)for(a[1]=a[1]?a[1]:"",a[1]=Math.round(parseFloat(a[1].substr(0,b)+"."+a[1].substr(b,a[1].length),10)),isNaN(a[1])&&(a[1]=""),b-=a[1].toString().length,h=0;h<b;h++)a[1]+="0";return a.join(d)};b.add(e)});return b};a.fn.JBZooBasket=function(e){e=a.extend({},{},e);var d=a(".jbzoo .shipping-list").JBCartShipping({no_value_message:"Free"});return a(this).each(function(){function c(){k.removeClass("loading",
100);a("input, select, textarea",k).removeAttr("disabled")}function b(a,b){b=b||["","\u0430","\u043e\u0432"];a=""+a;return a.match(/^(.*)(11|12|13|14|15|16|17|18|19)$/)?b[2]:a.match(/^(.*)1$/)?b[0]:a.match(/^(.*)(2|3|4)$/)?b[1]:a.match(/^(.*)$/)?b[2]:b[0]}function h(b){k.addClass("loading",100);a("input, select, textarea",k).attr("disabled","disabled");var h=b.closest("tr").data("itemid"),g=b.closest("tr").data("key");JBZoo.ajax({url:e.deleteUrl,data:{itemid:h,key:g,shipping:d.getParams()},success:function(d){var h=
b.closest("tr");h.slideUp(300,function(){h.remove();0==k.find("tbody tr").length&&window.location.reload()});f(d);a.fn.JBZooPriceReloadBasket();c()},error:function(a){c()}})}var k=a(this),f=function(c){for(var f in c.prices.items){var h=c.prices.items[f];a(".row-"+f);a(".row-"+f+" .jsSubtotal .jsValue",k).reCount(h.total,{decimals:2})}f=a(".jsTotalCount .jsValue",k);var h=a(".jsTotalPrice .jsValue",k),e=a(".jsMorphology",k),g=e.data("word");e.html(g+b(c.count));a(f).reCount(c.prices.count,{decimals:1,
duration:100});a(h).reCount(c.prices.total);d.setPrices(c.shipping)};a(".jsDelete",k).click(function(){h(a(this))});a(".jsDeleteAll",k.parents(".jbzoo")).click(function(){confirm(e.clearConfirm)&&JBZoo.ajax({url:e.clearUrl,success:function(){window.location.reload()}})});a(".jsQuantity",k).JBZooQuantity({"default":1,step:1,decimals:0});a(".jsQuantity",k).val();var g=function(b){var c=parseFloat(b.val()),h=b.parents(".jsQuantityTable").closest("tr");parseInt(h.data("itemid"),10);h=h.data("key");b.val().length&&
0<c&&JBZoo.ajax({url:e.quantityUrl+"&"+d.getParams(),data:{value:c,key:h},success:function(b){f(b);a.fn.JBZooPriceReloadBasket()},error:function(a){a.message&&alert(a.message)}})},m=0;a(".jsQuantity",k).keyup(function(){var b=a(this);clearTimeout(m);m=setTimeout(function(){g(b)},100)}).change(function(){var b=a(this);clearTimeout(m);m=setTimeout(function(){g(b)},100)})})};a.fn.JBZooQuantity=function(e){return this.each(function(){function d(a){a<f.min&&(a=f.min);a>f.max&&(a=f.max);isNaN(a)&&(a=f.min);
return parseFloat(a)}function c(a){a=d(a);return a.toFixed(f.decimals)}function b(a,b){a.preventDefault();a.stopPropagation();if(!m){m=!0;var c=parseInt(q.css("top")),d=0<b?1:-1;q.stop().animate({top:c+p.height()/2*d+"px"},{duration:200,complete:function(){q.stop().animate({top:c+"px"},{duration:200,complete:function(){m=!1}})}})}}function h(a,h){a.preventDefault();a.stopPropagation();var e=d(g.val())+h,k=0<h?1:-1,l;l=e<f.min?!1:e>f.max?!1:!isNaN(e);l?m||(m=!0,g.blur(),g.refresh(),g.trigger("change").val(c(e)),
q.stop().animate({top:k*p.height()+"px"},{duration:500,complete:function(){m=!1}})):b(a,h)}var k={"default":1,step:1,min:1,max:9999999,decimals:0,scroll:!0},f=function(b){if("undefined"!=typeof b){"undefined"!=typeof b.decimals&&(b.decimals=parseInt(b.decimals,10));"undefined"==typeof b.min&&"undefined"!=typeof b["default"]&&(b.min=b["default"]);if("undefined"==typeof b.step||0>=b.step)b.step=k.step;return a.extend({},k,b)}return k}(e),g=a(this),m=!1;if(g.hasClass("quantity-init"))return g;g.addClass("quantity-init");
g.drawBody=function(){var b=g.parent();a('<table cellpadding="0" cellspacing="0" border="0" class="jsQuantityTable quantity-table"><tr><td rowspan="2"><div class="item-count-wrapper"><div class="item-count"><dl class="item-count-digits"><dd></dd><dd></dd><dd></dd><dd></dd><dd></dd></dl></div></div></td><td><a href="#plus" class="jsAddQuantity plus btn-mini" title="Plus"></a></td></tr><tr><td><a href="#minus" class="jsRemoveQuantity minus btn-mini" title="Minus"></a></td></tr></table>').prependTo(b);
g.addClass("input-quantity").appendTo(a(".jsQuantityTable .item-count",b))};g.bindEvents=function(){a(".jsAddQuantity",l).on("click",function(a){g.add(a);return!1});a(".jsRemoveQuantity",l).on("click",function(a){g.remove(a);return!1});g.on("change",function(){g.val(c(g.val()));g.refresh()});!0===f.scroll&&g.bindScrollEvent();g.on("focus",function(){g.css("opacity","1");q.hide()}).on("keyup",function(){g.refresh()}).on("blur",function(){g.css("opacity","0");q.show()})};g.bindScrollEvent=function(){var b=
g.val(),h=g.val();a(n).on("mouseenter",function(){b=g.val();g.focus()});a(n).on("mouseleave",function(){h=g.val();h!=b&&g.trigger("change")});g.on("mousewheel",function(a){a.preventDefault(a);if(g.is(":focus")){var b=d(g.val());0<a.originalEvent.wheelDelta?(b+=f.step,b>f.max&&(b=f.max)):(b-=f.step,b<f.min&&(b=f.min));g.fadeOut(10,function(){g.fadeIn(10,function(){g.val(c(b));g.refresh()})})}})};g.setDefault=function(){0===g.val().length?g.val(c(f["default"])):0<g.val().length&&g.val(c(g.val()))};
g.refresh=function(){for(var a=g.val(),a=d(a)+parseFloat(3*f.step),b=0;5>b;b++)a-=f.step,p.eq(b).html(c(a));q.css({top:0,marginTop:2*-p.height()+"px"})};g.add=function(a){h(a,f.step)};g.remove=function(a){h(a,-f.step)};g.drawBody();var l=g.parents(".jsQuantityTable"),n=a(".item-count",l),p=a(".item-count-digits dd",l),q=a(".item-count-digits",l);a(".jsAddQuantity",l);a(".jsRemoveQuantity",l);g.setDefault();g.refresh();g.bindEvents()})};a.fn.JBCompareButtons=function(e){e=a.extend({},{},e);return a(this).each(function(){var d=
a(this);if(d.hasClass("jbcompare-init"))return!0;d.addClass("jbcompare-init");a(".jsCompareToggle",d).click(function(){var c=a(this);JBZoo.ajax({url:c.attr("href"),success:function(a){a.status?d.removeClass("unactive").addClass("active"):(a.message&&alert(a.message),d.removeClass("active").addClass("unactive"))}});return!1})})};a.fn.JBFavoriteButtons=function(e){e=a.extend({},{},e);return a(this).each(function(){var d=a(this);if(d.hasClass("jbfavorite-init"))return!0;d.addClass("jbfavorite-init");
a(".jsFavoriteToggle",d).click(function(){var c=a(this);JBZoo.ajax({url:c.attr("href"),success:function(a){a.status?d.removeClass("unactive").addClass("active"):(a.message&&alert(a.message),d.removeClass("active").addClass("unactive"))}});return!1});a(".jsJBZooFavoriteRemove",d).click(function(){var c=a(this);JBZoo.ajax({url:c.attr("href"),success:function(b){b.result&&d.slideUp(function(){d.remove();0==a(".favorite-item-wrapper").length&&a(".jsJBZooFavoriteEmpty").fadeIn()})}});return!1})})};a.fn.JBZooPriceAdvanceDefaultValidator=
function(e){function d(){var c={},d={},f="";a(".jbpriceadv-variation-row",b).each(function(d){var e=a(this),g={},e=a(".simple-param",e).each(function(c){var d=a(this);f=b.setStatus(d);0<f.length&&(g[c]={value:f,index:d.index(),exists:!0})});0<Object.keys(g).length?c[d]=g:1<a(".jbpriceadv-variation-row",b).length&&0!==e.length&&(c[d]={empty:!0})});for(var e in c){var m=c[e],l={},n;for(n in c)for(var p in c[n])if("object"==typeof m[p]&&"object"==typeof c[n][p]){var q=a.trim(m[p].index),r=a.trim(m[p].value);
a.trim(c[n][p].index)==q&&a.trim(c[n][p].value)==r&&a.trim(Object.keys(c[n]).length)==a.trim(Object.keys(m).length)&&e!=n&&(l[q]={variant:n,elem_index:q,elem_value:r})}!1===m.exists?d[e]={variant:e,exists:m.exists}:!0===m.empty?d[e]={variant:e,empty:m.empty}:0<Object.keys(m).length&&Object.keys(l).length==Object.keys(m).length&&(d[e]={variant:e,length:Object.keys(m).length,repeat:l})}return d}function c(c){a("input, select",c).on("change",function(){b.clearStyles();b.insertOptions();b.showErrors()})}
var b=e;b["super"]=e;b.refreshAllModeDefault=function(){a(".jbpriceadv-variation-row",b).each(function(){var b=a(this);a(".simple-param",b).each(function(){var b=a(this);c(b)})})};b.showErrors=function(){b.clearStyles();var c=d();if(0<Object.keys(c).length){var e=null,f;for(f in c){var g=a(".jbpriceadv-variation-row",b).eq(c[f].variant);b.setValid(!1);!1===c[f].exists?b["super"].setValid(!1):1==c[f].empty&&(b.setValid(!1),e=a(".variation-label .jsAttention",g),e.addClass("error"),b.addTooltipEmptyMessage(e));
for(var m in c[f].repeat)e=a(".jbprice-params",g).children().eq(c[f].repeat[m].elem_index),e=a(".jsJBPriceAttention",e),e.addClass("error"),b.addTooltipMessage(e)}}else b.setValid(!0)};b.refreshAllModeDefault();b.insertOptions();b.on("newvariation",function(){b.refreshAllModeDefault()});b.on("errorsExists",function(){b.showErrors();if(0==b.data("valid")){var c=d();0<Object.keys(c).length&&(c=c[Object.keys(c)[0]],a(".variations",b).is(":hidden")&&a(".jsShowVariations",b).trigger("click"),c=a(".jbpriceadv-variation-row",
b).eq(c.variant),c.removeClass("fieldset-hidden"),c.addClass("visible"),a("html, body").stop(!0).animate({scrollTop:c.offset().top},500))}});return b};a.fn.JBZooPriceAdvanceOverlayValidator=function(e){a(this).each(function(){function d(){var c={},d={},e=null;a(".jbpriceadv-variation-row",b).each(function(d){var g=a(this),g=a(".simple-param.active",g);0<g.length&&(e=b["super"].setStatus(g),0<e.length?c[d]={value:e,index:g.index(),empty:!1}:0==e.length&&1<a(".jbpriceadv-variation-row",b).length&&(c[d]=
{empty:!0}))});var g=0,m;for(m in c){var l=c[m],n=[],p;for(p in c)a.trim(c[p].index)==a.trim(l.index)&&a.trim(c[p].value)==a.trim(l.value)&&m!=p&&(g++,n.push(p),d[g]={variant:m,repeat:n,index:c[p].index,empty:c[p].empty});!0===l.empty&&(g++,d[g]={variant:m,empty:l.empty})}return d}function c(c){a("input, select",c).on("change",function(){var c=a(this),d=c.parents(".simple-param"),c=c.parents(".jbpriceadv-variation-row");b["super"].clearStyles();b["super"].disableParams(c);b["super"].setStatus(d);
0==a(".simple-param.active",c).length&&b["super"].activateParams(c);b["super"].insertOptions();b["super"].showErrors()})}var b=a(this);b.hasClass("init");b["super"]=e;e.showErrors=function(){var c=d();if(0<Object.keys(c).length){for(var e in c){var f=a(".jbpriceadv-variation-row",b).eq(c[e].variant);if(1==c[e].empty){var g=a(".variation-label .jsAttention",f);g.addClass("error");b["super"].addTooltipEmptyMessage(g)}f=a(".jbprice-params",f).children().eq(c[e].index);f=a(".jsJBPriceAttention",f);f.addClass("error");
b["super"].addTooltipMessage(f)}b["super"].setValid(!1)}else b["super"].setValid(!0)};b.refreshAllModeOverlay=function(){a(".jbpriceadv-variation-row",b).each(function(){var d=a(this);b["super"].disableParams(d);a(".simple-param",d).each(function(){var d=a(this);b["super"].setStatus(d);c(d)});0==a(".simple-param.active",d).length&&b["super"].activateParams(d)})};b.refreshAllModeOverlay();b["super"].insertOptions();e.showErrors();b.on("newvariation",function(){b.refreshAllModeOverlay()});b.on("errorsExists",
function(){e.showErrors();if(!1===b.data("valid")){var c=d(),k;for(k in c)var f=c[k].variant;0<Object.keys(c).length&&(a(".variations",b).is(":hidden")&&a(".jsShowVariations",b).trigger("click"),c=a(".jbpriceadv-variation-row",b).eq(f),c.removeClass("fieldset-hidden"),c.addClass("visible"),a("html, body").stop(!0).animate({scrollTop:c.offset().top},500))}});b.addClass("init");return b})};a.fn.JBZooPriceAdvanceValidator=function(e){var d=this;a(this).each(function(){d.setValid=function(a){a={valid:a};
d.data(a)};d.setStatus=function(c){var b=a("select, input",c),e="",e=null;"radio"==b.attr("type")?(e=a('input[type="radio"]:checked',c),e=a.trim(e.val())):e=a.trim(b.val());return 0<e.length?(d.activateParam(c),e):""};d.clearStyles=function(){a(".jbpriceadv-variation-row",d).each(function(){var c=a(this);a(".variation-label .jsAttention",c).removeClass("error").tooltip().tooltip("destroy");a(".simple-param",c).each(function(){var b=a(this);a(".jsJBPriceAttention",b).removeClass("error").removeClass("disabled").tooltip().tooltip("destroy")})})};
d.activateParam=function(c){c.removeClass("disabled");c.addClass("active");a(".jsJBPriceAttention",c).removeClass("disabled").tooltip().tooltip("destroy");a("input, select",c).removeAttr("disabled").removeAttr("readonly")};d.disableParam=function(c){c.removeClass("active");c.addClass("disabled");a(".jsJBPriceAttention",c).addClass("disabled");d.addTooltipMessage(a(".jsJBPriceAttention",c));a("input, select",c).attr({disabled:"true",readonly:"true"})};d.activateParams=function(c){a(".simple-param",
c).each(function(){d.activateParam(a(this))})};d.disableParams=function(c){a(".simple-param",c).each(function(){d.disableParam(a(this))})};d.addTooltipMessage=function(a){a.hasClass("error")?(a.attr("title","These values \u200b\u200bare already in another variation"),a.tooltip(),a.effect("pulsate")):a.hasClass("disabled")&&(a.attr("title","In this mode you can choose only one parameter"),a.tooltip())};d.addTooltipEmptyMessage=function(a){a.attr("title","No parameters selected");a.tooltip()};d.insertOptions=
function(){a(".jbpriceadv-variation-row",d).each(function(){var c=a(this),b=a(".variation-label .options",c),d=a(".overflow",b),e=a(".jsVariantPrice",b),f=[],g=a(".core-param .description",c),m=a(".variation-label",c);"undefined"!=typeof g.val()&&0<g.val().length&&a(".description",m).html(g.val());g=a(".variant-value",c).val();m=a(".variant-currency",c).val();d.html("");e.html(g+" "+m.toUpperCase());var l=0;a(".core-param",c).each(function(){var b=a(this),c=a("input, select",b);c.attr("type");var d=
a(".label",b),e=a.trim(c.val()),g=[],h=a.trim(d.text());if(1<c.length&&0<e.length){var k=0;a("input, select",b).each(function(){var b=a(this),c=a.trim(b.val()),d=b.attr("type");if("radio"==d&&b.is(":checked")&&0<c.length||"radio"!=d&&0<c.length)g.key=h,g[k]=c,k++});0<g.length&&(f.push(g),l++)}else 0<e.length&&1===c.length&&(f[l]=h+": "+e,l++)});for(g=0;g<f.length;g++)if("object"==typeof f[g]){var m=f[g].key,n=f[g].join(" ");f[g]=m+": "+n}e.attr("title",f.join("<br/>"));e.tooltip();a(".simple-param",
c).each(function(c){var e=a(this),f={},g=a("input, select, textarea",e),l=g.attr("type"),k=a(".label",e);"radio"==l?(e=a('input[type="radio"]:checked',e),0<a.trim(e.val()).length&&(f[c]={value:a.trim(e.val()),key:a.trim(k.text())})):"select"==l?0<a.trim(g.val()).length&&(f[c]={value:a.trim(g.val()),key:a.trim(k.text())}):"undefined"!=typeof g.val()&&0<a.trim(g.val()).length&&(f[c]={value:a.trim(g.val()),key:a.trim(k.text())});"undefined"!=typeof f[c]&&d.append('<div class="option"><span title="'+
f[c].key+'" class="key">'+f[c].value+"</span></div>");a(".option .key",b).tooltip()})})};e=a.extend({},{price_mode:1},e);if(2===e.price_mode)return d.JBZooPriceAdvanceOverlayValidator(d);if(1===e.price_mode)return d.JBZooPriceAdvanceDefaultValidator(d)});return d};a.fn.JBZooPriceAdvanceAdmin=function(e){return a(this).each(function(d,c){function b(){a(".jbpriceadv-variation-row .jbremove",f).show();a(".jbpriceadv-variation-row",f).each(function(){var b=a(this);a('input[type="radio"]',b).each(function(){var b=
a(this),c=Math.floor(999999*Math.random()+1);b.attr("name",b.attr("name").replace(/\[variations\]\[\d\]/i,"[variations-"+c+"]["+d+"]"))})});a(".jbpriceadv-variation-row",f).each(function(b,c){var d=a(this);a(".variation-label",d);0==b&&a(".jbremove",d).hide();a(".list-num",d).text(b+1);!a(".row-sku",d).val()&&e.base_sku&&a(".row-sku",d).val(e.base_sku);""==a(".row-balance",d).val()&&a(".row-balance",d).val("-1");a("input[type=text], input[type=checkbox], select, textarea",d).each(function(){var c=
a(this);c.attr("name",c.attr("name").replace(/\[variations\]\[\d\]/i,"[variations]["+b+"]"))});a('input[type="radio"]',d).each(function(){var c=a(this);c.attr("name",c.attr("name").replace(/\[variations\-\d*\]\[\d\]/i,"[variations]["+b+"]"));1==c.is(":checked")&&c.attr("checked","checked")})})}function h(){a(".jbpriceadv-variation-row",f).each(function(){var b=a(this),c=a(".jsToggleVariation",b);if(!c.hasClass("init"))c.on("click",function(){b.toggleClass("visible fieldset-hidden");b.removeClass("visible").siblings().addClass("fieldset-hidden")});
c.addClass("init")})}function k(){a(".jbpriceadv-variation-row",f).delegate(".jsJBMove","mousedown",function(){a(".jbpriceadv-variation-row",f).removeClass("visible").addClass("fieldset-hidden")});a(".jsJBMove",f).sortable({forcePlaceholderSize:!0,items:a(".jbpriceadv-variation-row",f),placeholder:"ui-state-highlight",stop:function(a,c){b();m.showErrors()}}).disableSelection()}var f=a(c),g=a(".variations",f);if(0===g.length)return!1;e=a.extend({},{price_mode:0,text_variation_show:"Show variations",
text_variation_hide:"Hide variations",adv_field_param_edit:0,all_params:{},base_currency:a(".basic-currency",f).val(),base_sku:a(".basic-sku",f).val()},e);var m=f.JBZooPriceAdvanceValidator({price_mode:e.price_mode});h();k();b();a(".jbpriceadv-variation-row",f).addClass("fieldset-hidden");e.adv_field_param_edit||a.each(e.all_params,function(b,c){a(".element-"+c).hide()});a(".jsShowVariations",f).click(function(){g.is(":hidden")?(a(this).text(e.text_variation_hide),g.slideDown()):(a(this).text(e.text_variation_show),
g.slideUp());return!1});a(".variations-list").on("stop-move",function(){b()});a(".jsNewPrice",f).click(function(){var c=a(".jbpriceadv-variation-row:first",f).clone().hide();a("input, select, textarea, select option:selected",c).removeAttr("id").removeAttr("checked").removeAttr("selected").unbind();a('input[type="text"], textarea',c).val("");a(".jsToggleVariation",c).removeClass("init").unbind();var d=a(".jbzoo-colors",c);0<d.length&&(d.removeClass("jbcolor-initialized"),a(".jbcolor-label",d).removeClass("checked"),
a(".jbcolor-input",d).unbind().removeClass("checked"),d.JBColorHelper({multiple:!1}));d=a(".jbprice-img-row-file",c);0<d.length&&(a("span, button",d).remove(),d.removeClass("JBPriceImage-init").attr("id",Math.random().toString(36).replace(".","")).initJBPriceAdvImage());a(".variation-label .description, .variation-label .options .overflow, .variation-label .options .jsVariantPrice",c).html("");a(".variation-label .options .jsVariantPrice",c).removeAttr("title data-original-title").unbind();a("label",
c).removeAttr("for");a(".variant-param",c).each(function(b){var c=a(this),d=parseInt((new Date).getTime()+b);a(" > * label",c).each(function(b){var c=a(this),e=Math.floor(999999*Math.random()+1);d+=b+e;c.attr("for",d);a("input",c).attr("id",d);c.prev("input").attr("id",d)})});a(".variations-list",f).append(c);b();h();k();f.trigger("newvariation");c.slideDown();return!1});f.on("click",".jbremove",function(){var c=a(this).closest(".jbpriceadv-variation-row");c.slideUp(300,function(){c.remove();b()});
m.showErrors()})})};a.fn.initJBPriceAdvImage=function(){var e=location.href.match(/^(.+)administrator\/index\.php.*/i)[1],d=a("form.item-edit");return a(".jbprice-img-row-file",d).each(function(c){var b=a(this);if(b.hasClass("JBPriceImage-init"))return b;b.addClass("JBPriceImage-init");var b=a(".jsJBPriceImage",b),d="jsJBPriceImage-"+c;c=a('<button type="button" class="jbprice-img-button" />').text("Select Image").insertAfter(b);var k=a('<span class="jbprice-img-cancel image-cancel"/>').insertAfter(b);
b.attr("id",d);k.click(function(){k.prev().val("")});c.click(function(a){a.preventDefault();SqueezeBox.fromElement(this,{handler:"iframe",url:"index.php?option=com_media&view=images&tmpl=component&e_name="+d,size:{x:850,y:500}})});var f="insertJBPriceImage"+d;a.isFunction(window.jInsertEditorText)&&(window[f]=window.jInsertEditorText);window.jInsertEditorText=function(b,c){if(c.match(/^jsJBPriceImage-/)){var d=a("#"+c),h=b.match(/src="([^\"]*)"/)[1];d.parent().find("img").attr("src",e+h);d.val(h)}else a.isFunction(window[f])&&
window[f](b,c)}})};a.fn.JBCascadeSelect=function(e){var d=a(this),c={uniqid:"",items:null,text_all:"All"},b={},h=function(c,d){b[d]=a("select",c);b[d].change(function(){var b=a(this),e=parseInt(b.attr("list-order"),10),b=b.val(),g=f(e,d),h=a(".jbselect-"+(e+1),c);k(h,b,g,e,!1);1<h.find("option").length&&h.removeAttr("disabled");h.trigger("change")}).each(function(b,c){var e=a(c),h=parseInt(e.attr("list-order"),10),k=e.val();f(h,d);e.attr("disabled","disabled");g(k)||e.removeAttr("disabled");1<e.find("option").length&&
e.removeAttr("disabled")})},k=function(b,d,e,f,h){var k=c.items;m(b);h||a.each(e,function(a,b){if("undefined"!=typeof k[b])k=k[b];else return g(b)&&(k={}),!1});a.each(k,function(a,c){l(b,a,a)})},f=function(c,d){for(var e={},f=0;f<=c;f++){var g=a(b[d].get(f)).val();e[f]=g}return e},g=function(b){return"undefined"==typeof b?!1:!a.inArray(b,[""," ","0"])},m=function(a){a.empty();a.attr("disabled","disabled");return l(a,"",c.text_all)},l=function(b,c,d){c=a("<option>").attr("value",c).html(d);return b.append(c)};
if(!d.length)return d;c=a.extend({},c,e);a(".jbcascadeselect",d).each(function(b,c){h(a(c),b)});var n=a(".repeat-elements",d);n.find("p.add").bind("click",function(){var b=n.find("li.repeatable-element").length-1,c=d.find(".jbcascadeselect:eq("+b+")");a("select",c).each(function(b,c){0!=b?m(a(c)):a(c).val("")});h(c,b)});return d};a.fn.JBZooPrice=function(e){return a(this).each(function(d,c){var b=a(c);a(".jsPriceCurrency",b).click(function(){var c=a(this),d=c.attr("currency");a(".jsPriceValue",b).removeClass("active");
a(".price-currency-"+d,b).addClass("active");a(".jsPriceCurrency",b).removeClass("active");c.addClass("active")});a(".jsAddToCart",b).click(function(){var b=a(this).data("href"),b=-1==b.indexOf("?")?b+"?format=raw&tmpl=component":b+"&format=raw&tmpl=component";a.fancybox({type:"iframe",href:b,width:360,autoHeight:!0,autoResize:!0,fitToView:!0,iframe:{scrolling:"no",preload:!0},helpers:{overlay:{locked:!1,css:{background:"rgba(119, 119, 119, 0.4)"}}}});return!1});a(".jsBayIt",b).click(function(){var c=
a(this),d=0;a(".jbprice-row input:checked",b).length&&(d=a(".jbprice-row input:checked",b).val());JBZoo.ajax({url:c.data("href"),data:{args:{quantity:a(".jsQuantity").val(),indexPrice:d}},success:function(a){a.result&&(window.location.href=a.basketUrl)}});return!1});a(".jsRemoveFromCart",b).click(function(){var c=a(this);JBZoo.ajax({url:c.data("href"),success:function(c){b.removeClass("in-cart").addClass("not-in-cart");a.fn.JBZooPriceReloadBasket()}});return!1})})};a.fn.JBZooPriceToggle=function(e,
d){a(".jsPrice-"+e+"-"+d+", .jsJBPriceAdvance-"+e+"-"+d).removeClass("not-in-cart").addClass("in-cart");a.fn.JBZooPriceReloadBasket()};a.fn.JBZooPriceReloadBasket=function(){a(".jsJBZooModuleBasket").each(function(e,d){var c=a(d);JBZoo.ajax({data:{controller:"basket",task:"reloadModule",app_id:c.attr("appId"),moduleId:c.attr("moduleId")},dataType:"html",success:function(a){c.closest(".jbzoo").replaceWith(a)}})})};a.fn.JBZooProgressBar=function(e){function d(a){if(0>=a||isNaN(a))return"00:00";var b=
Math.floor(a/60);a%=60;10>a&&(a="0"+a);10>b&&(b="0"+b);return b+":"+a}function c(){q=0;s=setInterval(function(){e.onTimer({passed:d(++q),remaining:d(parseInt(100*q/p-q,10))})},1E3)}function b(){p=0;l.hide();n.show();g.addClass("uk-progress-striped uk-active");a(".jsErrorBlockWrapper").hide();a(".jsErrorBlock").empty();r=!1;k(0);e.onStart();c()}function h(){l.show();n.hide();g.removeClass("uk-progress-striped uk-active");r=!0;clearInterval(s);e.onStop()}function k(b){r||100<=p?h():JBZoo.ajax({url:e.url,
data:{page:b},success:function(a,c){p=a.progress;e.onRequest(a);m.css("width",p+"%");100<=a.progress?(m.text(e.text_wait),e.onFinal(function(){m.text(e.text_complete)}),h()):(m.text(p+" %"),k(++b))},onFatal:function(b){a(".jsErrorBlock").html(b.responseText);a(".jsErrorBlockWrapper").fadeIn();h()}})}e=a.extend({},{text_complete:"Complete!",text_stop_confirm:"Are you sure?",text_start_confirm:"Are you sure?",text_start:"Start",text_stop:"Stop",text_ready:"Ready",text_wait:"Wait please ...",autoStart:!1,
url:"",onStart:new Function,onStop:new Function,onRequest:new Function,onTimer:new Function,onFinal:function(a){a()}},e);var f=a(this);f.html('<div id="jbprogressbar" class="uk-progress"><div class="uk-progress-bar" style="width: 100%;">'+e.text_ready+'</div></div><div class="clr"></div><input type="submit" class="jsStart uk-button uk-button-success" value="'+e.text_start+'" /><input type="button" class="jsStop uk-button" value="'+e.text_stop+'" style="display:none;" />');var g=a("#jbprogressbar",
f),m=a(".uk-progress-bar",f);a(".progress-label",f);var l=a(".jsStart",f),n=a(".jsStop",f),p=0,q=0,r=!0,s=0;l.bind("click",function(){confirm(e.text_start_confirm)&&b();return!1});n.bind("click",function(){confirm(e.text_stop_confirm)&&h();return!1});e.autoStart&&(b(),l.hide(),n.hide())};a.fn.JBZooPriceAdvanceBalanceHelper=function(){return a(this).each(function(){function e(a){c.removeAttr("disabled");1!=a&&(c.attr("disabled",!0),c.val(""))}var d=a(this),c=a(".jsBalanceInput",d);a('input[type="radio"]',
d).on("change",function(){var b=a(this);e(b.val())});e(a('input[type="radio"]:checked',d).val())})};a.fn.JBZooViewed=function(e){e=a.extend({},{message:"Do you really want to delete the history?",app_id:""},e);var d=a(this);if(d.hasClass("module-items-init"))return d;d.addClass("module-items-init");return d.find(".jsRecentlyViewedClear").on("click",function(){confirm(e.message)&&JBZoo.ajax({data:{controller:"viewed",task:"clear",app_id:e.app_id},dataType:"html",success:function(){d.slideUp("slow")}});
return!1})};a.fn.JBZooHeightFix=function(){var e=a(this),d=0;setTimeout(function(){a(".column",e).each(function(c,b){var e=parseInt(a(b).height(),10);d<e&&(d=e)}).css({height:d})},300)};a.fn.JBColorHelper=function(e){e=a.extend({},{multiple:!0,method:""},e);return a(this).each(function(){var d=a(this);d.find("input[type="+e.type+"]:checked").next().addClass("checked");if(d.hasClass("jbcolor-initialized"))return d;d.addClass("jbcolor-initialized");a(".jbcolor-input",d).on("click",function(){var c=
a(this);e.multiple?c.hasClass("checked")?(c.removeClass("checked").next().removeClass("checked"),c.trigger("change")):c.addClass("checked").next().addClass("checked"):c.hasClass("checked")?(c.attr("checked",!1).addClass("unchecked").removeClass("checked").next().removeClass("checked"),c.trigger("change")):(a(".jbcolor-input",d).removeClass("checked"),a(".jbcolor-label",d).removeClass("checked"),c.attr("checked",!0).addClass("checked").removeClass("unchecked").next().addClass("checked"))})})};a.fn.JBInputHelper=
function(e){var d=a.extend({},{base:".ghost",label:".upgrd-label",classes:{hover:"hover",active:"active",focus:"focus"},multiple:!1,parent:".shipping-default"},e);return a(this).each(function(){var c=a(this),b=c.prev(d.label);if(c.hasClass("init"))return c;c.addClass("init");c.on("click",function(){a(d.label).remove(d.classes);b.addClass("checked")});b.on("mouseenter",function(){b.addClass("hover")});b.on("mouseleave",function(){b.removeClass("hover")})})};a.fn.JBCartShipping=function(e){var d=a.extend({},
{no_value_message:"Free"},e),c=[],b=a(this),h=!1;b.getParams=function(){var b={},d;for(d in c){var e=c[d];if(0<Object.keys(e).length){var h=a(".jsInputShippingService",e).val(),e=a(".jsCalculate",e),k={};a("input, select",e).each(function(){var b=a(this);if("undefined"!=typeof b.attr("name")){var c=b.attr("name");0<a.trim(b.val()).length&&(c=c.replace(/shipping(?:[\[])(\w+)(?:[\]])/,"$1"),k[c]=b.val())}});0<Object.keys(k).length&&(b[h]=k)}}return a.param({shipping:b})};b.recount=function(){for(var a in c)c[a].getPrice();
return b.getPrice()};b.createPlugins=function(){!1===h&&a(".jsShippingElement",b).each(function(){0<a(this).length&&(a("select",a(this)).chosen(),b.createPlugin(a(this)),h=!0)});return c};b.getPrice=function(){for(var b in c)a(".jsInputShippingService:checked",c[b])};b.setPrices=function(d){if(0<Object.keys(d).length)for(var e in d){var h=a('.jsInputShippingService[value="'+e+'"]',a(".jbzoo .shipping-list")),k=h.parents(".jsShippingElement").data("type"),n=h.next();h.is(":checked")&&b.setPrice(d[e]);
c[k].price=d[e].price;a(".shipping-info .value .jsValue",n).html(d[e].price);a(".shipping-info .value .jsCurrency",n).html(d[e].symbol)}};b.setPrice=function(c){"undefined"==c&&(c=d.no_value_message);a(".jsShippingPrice .jsValue",b.parents(".jbzoo")).html(c.price);a(".jsShippingPrice .jsCurrency",b.parents(".jbzoo")).html(c.symbol)};var k=function(c){var d=b.parents(".jbzoo").find(".shippingfileds-list");d.addClass("loading");d.show();0<c.indexOf(":")?(c=".element-"+c.split(":").join(", .element-"),
a(c,d).fadeIn().find("input, select, textarea").removeAttr("disabled"),a("div.element:not("+c+")",d).fadeOut(function(){a(this).find("input, select").attr("disabled","disabled")})):0<c.length?(a(".element-"+c,d).fadeIn().find("input, select, textarea").removeAttr("disabled"),a("div.element",d).not(".element-"+c).fadeOut(function(){a(this).find("input, select, textarea").attr("disabled","disabled")})):d.hide();setTimeout(function(){d.removeClass("loading")},500)};a(".jsInputShippingService",b).on("change",
function(){var d=a(this).parents(".jsShippingElement"),e=c[d.data("type")];b.setPrice({price:e.price,symbol:e.symbol});d.addClass("active");d.siblings(".element").removeClass("active");b.toggleShipFields(d);b.hide();b.show(d)});b.hide=function(){a(".jsMoreOptions",b).slideUp("fast",function(){})};b.show=function(b){a(".jsMoreOptions",b).slideDown("fast");a(".jsMoreOptions input, .jsMoreOptions select",b).removeAttr("disabled")};b.toggleShipFields=function(a){if(a=a.data("settings"))var b=a.shippingfields;
"undefined"!=typeof b&&k(b)};b.createPlugin=function(d){var e=d.data("type"),h=null;"undefined"==typeof e&&(e="default");e=a.trim("JBCartShipping"+e.toLowerCase());if("undefined"!=typeof c[d.data("type")]&&0!==c[d.data("type")].length)return c[d.data("type")];a.isFunction(a.fn[e])||(e=a.trim("JBCartShippingdefault"));h=d[e]({"super":b});return c[d.data("type")]=h};e=a(".jsInputShippingService:checked",b).parents(".jsShippingElement");e.addClass("active");e.siblings(".element").removeClass("active");
b.createPlugins();0<e.length&&b.toggleShipFields(e);b.hide();b.show(e);return b};a.fn.JBCartShippingdefault=function(e){var d=a.extend({"super":{}},e,a(this).data("settings")),c=a(this);a(this).each(function(){var b=a(this);c.price=d.default_price;c.symbol=d.symbol;c.getPrice=function(){var e={};a(".jsCalculate input:not(input:disabled), .jsCalculate select:not(select:disabled)",b).each(function(){var b=a(this),c=a.trim(b.val()),b=b.attr("id");0<c.length&&(b=b.replace("shipping",""),e[b]=c)});0<Object.keys(e).length&&
(c.addClass("loading"),JBZoo.ajax({url:d.getPriceUrl,data:{args:{fields:JSON.stringify(e)}},dataType:"json",success:function(e){d["super"].setPrice(e);c.price=e.price;a(".shipping-element .field-label .value .jsValue",b).html(e.price);a(".shipping-element .field-label .value .jsCurrency",b).html(e.symbol);c.removeClass("loading")},error:function(a){c.removeClass("loading")}}))};if(b.hasClass("shipping-init"))return c;a(".jsCalculate select, .jsCalculate input",b).on("change",function(){c.getPrice(a(this).val())});
b.addClass("shipping-init")});return c};a.fn.JBCartShippingemspost=function(e){var d=a.extend({"super":{},toDoors:3,toWrn:4},e,a(this).data("settings")),c=a(this);a(this).each(function(){var b=a(this);c.price=d.default_price;c.symbol=d.symbol;c.getPrice=function(e){if("undefined"==typeof e||0===e.length)e=a("select option:selected",b).val();e={to:e};c.addClass("loading");JBZoo.ajax({url:d.getPriceUrl,data:{args:{to:JSON.stringify(e)}},dataType:"json",success:function(e){d["super"].setPrice(e);c.price=
e.price;a(".shipping-element .field-label .value .jsValue",b).html(e.price);a(".shipping-element .field-label .value .jsCurrency",b).html(e.symbol);c.removeClass("loading")},error:function(a){c.removeClass("loading")}})};if(b.hasClass("shipping-init"))return c;a("#shippingto",b).on("change",function(){var d=a(this).val();a("#shippingcountryto",b).attr("disabled","disabled");0===d.length&&a("#shippingcountryto",b).removeAttr("disabled");a("#shippingcountryto",b).trigger("liszt:updated").trigger("chosen:updated");
c.getPrice(d)});a("#shippingcountryto",b).on("change",function(){var d=a(this).val();a("#shippingto",b).attr("disabled","disabled");0===d.length&&a("#shippingto",b).removeAttr("disabled");a("#shippingto",b).trigger("liszt:updated").trigger("chosen:updated");c.getPrice(d)});b.addClass("shipping-init")});return c};a.fn.JBCartShippingnewpost=function(e){var d=a.extend({"super":{},toDoors:3,toWrn:4},e,a(this).data("settings")),c=a(this);a(this).each(function(){function b(){return a(".jsNewPostSenderCity #shippingrecipientcity",
l)}function e(){return a.trim(a("#shippingregions option:selected",l).val().toLowerCase())}function k(){return a.trim(a(".jsNewPostSenderCity #shippingrecipientcity option:selected",l).val().toLowerCase())}function f(a){"undefined"==typeof a&&(a=e());return!0===n.hasOwnProperty(a)?n[a]:{}}function g(a){"undefined"==typeof a&&(a=k());return!0===p.hasOwnProperty(a)?p[a]:{}}function m(){a("#shippingstreet option",l).not(":first").remove()}var l=a(this);c.price=d.default_price;c.symbol=d.symbol;c.getPrice=
function(){var b={};a(".jsCalculate input:not(input:disabled), .jsCalculate select:not(select:disabled)",l).each(function(){var c=a(this),d=a.trim(c.val()),c=c.attr("id");0<d.length&&(c=c.replace("shipping",""),b[c]=d)});c.addClass("loading");JBZoo.ajax({url:d.getPriceUrl,data:{args:{fields:JSON.stringify(b)}},dataType:"json",success:function(b){d["super"].setPrice(b);c.price=b.price;a(".shipping-element .field-label .value .jsValue",l).html(b.price);a(".shipping-element .field-label .value .jsCurrency",
l).html(b.symbol);c.removeClass("loading")},error:function(a){c.removeClass("loading")}})};if(l.hasClass("shipping-init"))return c;var n={},p={};l.changePostType=function(b){b||(b=parseInt(a("#shippingdeliverytype_id option:selected",l).val(),10));b===d.toDoors?l.showBlockDoors():b===d.toWrn&&l.showBlockWarehouse()};l.showBlockDoors=function(){a(".jsAreaWarehouse",l).slideUp(function(){a("input, select",a(this)).attr("disabled","disabled")});a(".jsAreaDoors",l).slideDown().find("input, select").removeAttr("disabled")};
l.showBlockWarehouse=function(){a(".jsAreaDoors",l).slideUp(function(){a("input, select",a(this)).attr("disabled","disabled")});a(".jsAreaWarehouse",l).slideDown().find("input, select").removeAttr("disabled")};l.addLoading=function(){var c=b(),d=a(".jsNewPostWareehouse #shippingstreet",l);c.addClass("loading");d.addClass("loading")};l.removeLoading=function(){var c=b(),d=a(".jsNewPostWareehouse #shippingstreet",l);c.removeClass("loading");d.removeClass("loading")};l.setCities=function(a,b){"undefined"==
typeof a&&(a=e());if(0<Object.keys(f(a)).length&&b)return b(),!1;l.addLoading();JBZoo.ajax({url:d.getCitiesUrl,data:{args:{region:a}},dataType:"json",success:function(a){a=a.cities;var c=e();"object"==typeof a&&0<Object.keys(a).length&&(n[c]=a);b&&b();l.removeLoading()},error:function(a){l.removeLoading()}})};l.addCities=function(c){"undefined"==typeof c&&(c=e());c=f(c);var d=b();a("#shippingrecipientcity option",l).not(":first").remove();"undefined"!=typeof c&&a.each(c,function(b,c){d.append(a("<option/>",
{value:b,text:c}))});d.trigger("liszt:updated").trigger("chosen:updated")};l.setWarehouses=function(b,c){b||(b=k());if(0<Object.keys(g(b)).length&&c)return c(),!1;var e=a(".jsNewPostWareehouse #shippingstreet",l);e.addClass("loading");JBZoo.ajax({url:d.getWarehousesUrl,data:{args:{city:b}},dataType:"json",success:function(a){a=a.warehouses;var b=k();0<Object.keys(a).length&&(p[b]=a);c&&c();e.removeClass("loading")},error:function(a){e.removeClass("loading")}})};l.addWarehouses=function(b){b||(b=k());
b=g(b);var c=a(".jsNewPostWareehouse #shippingstreet",l);m();a.each(b,function(b,d){c.append(a("<option/>",{value:b,text:d}))});c.trigger("liszt:updated").trigger("chosen:updated")};a("#shippingdeliverytype_id",l).on("change",function(){l.changePostType()});a(".jsCalculate select",l).on("change",function(){c.getPrice()});a("#shippingregions",l).on("change",function(){m();l.setCities(e(),l.addCities)});a("#shippingrecipientcity",l).on("change",function(){l.setWarehouses(k(),l.addWarehouses)});l.changePostType();
l.addClass("shipping-init")});return c};a.fn.JBZooEmailPreview=function(e){e=a.extend({},{url:""},e);return a(this).each(function(){var d=a(this);a(".jsEmailTmplPreview",d).on("click",function(){a("#jsOrderList",d).toggle();return!1});a("#jsOrderList .order-id",d).on("click",function(){var c=a(this),c=e.url+"&id="+c.data("id");SqueezeBox.initialize({});SqueezeBox.open(c,{handler:"iframe",size:{x:1050,y:700}});return!1})})}})(jQuery);
(function(){window.JBZoo=new JBZooHelper;window.jbdump=window.dump=function(){JBZoo.DEBUG&&JBZoo.jbdump.apply(this,arguments)}})();